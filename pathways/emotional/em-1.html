<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0d0906">
  <title>InnerShadow ‚Äì What Emotions Actually Are</title>
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="/css/main.css">
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    html, body {
      position: fixed;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-dark);
    }

    .shell {
      width: 100%;
      max-width: 28rem;
      height: 100vh;
      height: -webkit-fill-available;
      background: var(--bg-card);
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
      border-left: 1px solid var(--border-subtle);
      border-right: 1px solid var(--border-subtle);
    }

    .module-header {
      padding: max(1rem, env(safe-area-inset-top)) 1.25rem 0.875rem;
      background: rgba(10,15,30,0.95);
      border-bottom: 1px solid var(--border-subtle);
      flex-shrink: 0;
      z-index: 10;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .module-header__row {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }

    .header-back {
      width: 2.25rem;
      height: 2.25rem;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-card-light);
      border: 1px solid var(--border-soft);
      border-radius: 0.625rem;
      color: var(--text-primary);
      font-size: 1rem;
      cursor: pointer;
      transition: var(--transition-fast);
      flex-shrink: 0;
    }

    .header-back:active { transform: scale(0.92); }
    .header-back:disabled { opacity: 0.3; cursor: default; }

    .header-title {
      flex: 1;
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.3;
      text-align: center;
    }

    .header-count {
      font-size: 0.8125rem;
      color: var(--text-muted);
      font-weight: 500;
      min-width: 2.25rem;
      text-align: right;
    }

    .progress-dots {
      display: flex;
      gap: 0.3rem;
    }

    .progress-dot {
      flex: 1;
      height: 3px;
      background: rgba(148,163,184,0.15);
      border-radius: 999px;
      transition: background 0.4s ease;
    }

    .progress-dot--active {
      background: var(--gradient-main);
    }

    .module-scroll {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }

    .module-scroll::-webkit-scrollbar { display: none; }

    .step-wrap {
      padding: 1.375rem 1.25rem 2rem;
    }

    .cta-area {
      padding: 1rem 1.25rem max(1rem, env(safe-area-inset-bottom));
      background: rgba(10,15,30,0.95);
      border-top: 1px solid var(--border-subtle);
      display: flex;
      gap: 0.75rem;
      align-items: center;
      flex-shrink: 0;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .back-btn-sm {
      width: 3rem;
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-card-light);
      border: 1px solid var(--border-soft);
      border-radius: 0.875rem;
      color: var(--text-secondary);
      font-size: 1.125rem;
      cursor: pointer;
      transition: var(--transition-fast);
      flex-shrink: 0;
    }

    .back-btn-sm:active { transform: scale(0.92); }
    .back-btn-sm:disabled { opacity: 0.3; cursor: default; }

    @media (min-width: 640px) {
      .shell {
        height: 844px;
        max-height: 92vh;
        border-radius: 2.5rem;
        border: 1px solid var(--border-subtle);
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="bg-orb bg-orb--ember"></div>
    <div class="bg-orb bg-orb--amber"></div>

    <div class="module-header">
      <div class="module-header__row">
        <button class="header-back" id="headerBackBtn" onclick="ModuleEngine.goBackToPathway()">‚Üê</button>
        <p class="header-title" id="moduleTitle">What Emotions Actually Are</p>
        <span class="header-count" id="stepCounter"></span>
      </div>
      <div class="progress-dots" id="progressDots"></div>
    </div>

    <div class="module-scroll" id="moduleScroll">
      <div class="step-wrap" id="stepContent"></div>
    </div>

    <div class="cta-area">
      <button class="back-btn-sm" id="backBtn" onclick="ModuleEngine.back()" disabled>‚Üê</button>
      <button class="btn btn--primary" id="nextBtn" onclick="ModuleEngine.next()">Continue</button>
    </div>
  </div>

  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <div class="loading-text" id="loadingText">Loading...</div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="/js/supabase-client.js"></script>
  <script src="/js/utils.js"></script>
  <script src="/js/module-engine.js"></script>
  <script>

  const B = ModuleEngine.Blocks;

  const EM1_STEPS = [

    // ‚îÄ‚îÄ STEP 1: Intro ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'intro',
      render: () => `
        ${B.heading('Most of what you were taught about emotions is wrong.')}
        ${B.para('Not slightly off. Fundamentally wrong in ways that make emotional life significantly harder than it needs to be.')}
        ${B.para('You were probably taught that emotions are reactions to events. That they happen <em>to</em> you. That the goal is to control them, manage them, not let them get the better of you.')}
        ${B.para('That model produces people who are either at war with their inner life or completely flooded by it. Neither works.')}
        ${B.callout('This module teaches you what emotions actually are ‚Äî where they come from, what they\'re for, and why the standard advice about them makes everything worse.')}
        ${B.para('This is the foundation everything else builds on. Take your time with it.')}
      `
    },

    // ‚îÄ‚îÄ STEP 2: Concept ‚Äî Emotions as predictions ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'concept',
      render: () => `
        ${B.heading('Emotions are not reactions. They\'re predictions.')}
        ${B.para('Here\'s what the neuroscience actually says:')}
        ${B.para('Your brain is not a passive receiver of reality. It\'s a prediction machine. Constantly, automatically, it generates a model of what\'s happening based on past experience ‚Äî and emotions are part of that model.')}
        ${B.insight('The key shift', 'An emotion is not something that happens <em>to</em> you when an event occurs. It\'s your brain\'s best guess about what the event means, based on every similar situation you\'ve survived before.')}
        ${B.para('This is why two people can experience the exact same event ‚Äî a silence in a conversation, a text that doesn\'t come, a raised voice ‚Äî and feel completely different things. Their brains are making different predictions based on different histories.')}
        ${B.para('Your emotional life is not a verdict on what\'s actually happening. It\'s a hypothesis. And hypotheses can be examined.')}
      `
    },

    // ‚îÄ‚îÄ STEP 3: Concept ‚Äî Body first ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'concept',
      render: () => `
        ${B.heading('Your body registers emotion before your mind knows it\'s happened.')}
        ${B.para('Emotion is a physiological event first. Your body ‚Äî heart rate, breathing, tension in your shoulders, heaviness in your chest ‚Äî changes <em>before</em> your conscious mind has processed what\'s going on.')}
        ${B.steps([
          'An event happens ‚Äî or your brain anticipates one',
          'Your nervous system responds ‚Äî heart rate shifts, muscles change, breathing changes',
          '<strong>Then</strong> your mind labels what just happened: "I\'m anxious" or "I\'m angry" or "something feels wrong"',
          'You experience this as a single moment ‚Äî but it\'s a sequence'
        ])}
        ${B.para('If you only pay attention to the mental label, you miss most of the information the emotion is carrying. The body has already been speaking for seconds before you caught up.')}
        ${B.callout('The fastest route to understanding what you\'re feeling runs through your body, not your thoughts. This is why we return to the body again and again throughout this pathway.')}
      `
    },

    // ‚îÄ‚îÄ STEP 4: Concept ‚Äî Emotions as information ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'concept',
      render: () => `
        ${B.heading('Emotions are information. Not verdicts.')}
        ${B.para('Every emotion serves a function. Not a comfortable one necessarily ‚Äî but a function.')}
        <div style="display:flex;flex-direction:column;gap:0.5rem;margin-bottom:1.25rem">
          ${[
            ['üò∞','Anxiety','Signals potential threat. Prepares you to act. Not proof that danger is real.'],
            ['üò°','Anger','Signals something important to you has been violated. Not permission to act on it.'],
            ['üòû','Sadness','Signals loss. Slows you down so you can process it. Not weakness.'],
            ['üò®','Fear','Signals actual danger. Mobilises survival responses. Sometimes misfires.'],
            ['üò≥','Shame','Signals a threat to belonging. Often based on old, outdated rules.'],
            ['üòä','Joy','Signals alignment with what matters to you. Worth understanding, not just enjoying.']
          ].map(([emoji,name,desc]) => `
            <div style="
              display:flex;gap:0.875rem;align-items:flex-start;
              padding:0.875rem;
              background:var(--bg-card-light);
              border:1px solid var(--border-soft);
              border-radius:0.875rem;
            ">
              <span style="font-size:1.375rem;line-height:1;flex-shrink:0;margin-top:0.125rem">${emoji}</span>
              <div>
                <p style="font-size:0.875rem;font-weight:700;color:var(--text-primary);margin-bottom:0.2rem">${name}</p>
                <p style="font-size:0.8125rem;color:var(--text-secondary);line-height:1.5">${desc}</p>
              </div>
            </div>
          `).join('')}
        </div>
        ${B.para('The goal is not to feel good emotions and eliminate bad ones. The goal is to get better at reading the information that\'s already there.')}
      `
    },

    // ‚îÄ‚îÄ STEP 5: Worksheet ‚Äî Current vocabulary ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'worksheet',
      render: () => `
        ${B.heading('How big is your emotional vocabulary right now?')}
        ${B.para('Most people operate with around 5‚Äì7 emotional words. Sad, angry, anxious, fine, good, stressed, overwhelmed. That\'s it.')}
        ${B.para('Precision matters. The more specifically you can name what you\'re feeling, the more quickly it loses intensity and the more clearly it communicates what it\'s trying to tell you.')}
        ${B.divider('Your turn')}
        ${B.para('Think about the last time you felt something difficult. Not a crisis ‚Äî just a hard moment.', 'margin-bottom:0.75rem')}
        ${B.keyedTextarea('situation', 'The situation was...', 'Briefly describe it', '60px')}
        ${B.keyedTextarea('felt', 'I felt...', 'Use as many words as you can ‚Äî not just "sad" or "anxious". Try to be specific.', '90px')}
        ${B.keyedTextarea('body', 'In my body I noticed...', 'Where did you feel it? Chest, throat, stomach, jaw, shoulders...', '70px')}
        ${B.callout('There are no right answers. This is about building the habit of looking.')}
      `
    },

    // ‚îÄ‚îÄ STEP 6: Worksheet ‚Äî Deeper vocabulary ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'worksheet',
      render: () => `
        ${B.heading('Going one level deeper.')}
        ${B.para('Look at what you wrote. Now try to be more precise. Here are words people rarely use but often need:')}
        <div style="display:flex;flex-wrap:wrap;gap:0.4rem;margin-bottom:1.25rem">
          ${['Humiliated','Dismissed','Overlooked','Inadequate','Betrayed','Suffocated',
             'Restless','Hollow','Resigned','Resentful','Tender','Wistful','Exposed',
             'Unworthy','Grieving','Untethered','Longing','Invisible','Frantic','Raw']
            .map(word => `
              <span style="
                display:inline-block;padding:0.3rem 0.75rem;
                background:var(--bg-card-light);border:1px solid var(--border-soft);
                border-radius:999px;font-size:0.8125rem;color:var(--text-secondary);
              ">${word}</span>
            `).join('')}
        </div>
        ${B.divider('Revisit')}
        ${B.keyedTextarea('precise', 'The more accurate word or phrase is...', 'And that\'s different from what I first said because...', '110px')}
        ${B.insight('What you\'re practising', 'Granular emotional labelling ‚Äî research shows it reduces the intensity of the emotion within seconds of naming it accurately. This is a skill, and it gets easier with use.')}
      `
    },

    // ‚îÄ‚îÄ STEP 7: Skill unlock ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'skill',
      render: () => `
        ${B.heading('Your first tool.')}
        ${B.para('Deceptively simple. Backed by solid neuroscience. You\'ll use this for the rest of your life.')}
        ${B.skill(
          'Name It to Soften It',
          'Precise emotional labelling reduces intensity and creates space between feeling and reaction.',
          [
            '<strong>Notice something is happening.</strong> Emotion, discomfort, a pull ‚Äî whatever it is. Don\'t push past it.',
            '<strong>Get specific.</strong> Not "bad" or "stressed" ‚Äî what is it exactly? Frustrated? Ashamed? Lonely? Use the most precise word you can find.',
            '<strong>Say it to yourself:</strong> "There is [emotion] here." Not "I am [emotion]" ‚Äî that fuses you with it. "There is anger here" keeps you separate from it.',
            '<strong>Notice the shift.</strong> Accurate naming reduces amygdala activity within seconds. You\'re not suppressing ‚Äî you\'re labelling, which is what the brain actually needs to settle.'
          ]
        )}
        ${B.callout('<strong>The distinction that matters:</strong> "I am angry" makes you the emotion. "There is anger here" lets you observe it. Same words. Completely different relationship.')}
      `
    },

    // ‚îÄ‚îÄ STEP 8: Commitment ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'commitment',
      render: () => `
        ${B.heading('Before you go.')}
        ${B.para('The gap between understanding something and actually changing is practice. Not insight ‚Äî practice. Insight without practice produces people who know a lot and feel the same.')}
        ${B.commitment(
          'This week, use Name It to Soften It at least once a day ‚Äî not when it\'s convenient, when it\'s hard. Think of a specific situation coming up where emotions will be present. Write your commitment below.',
          'This week when [situation], I will pause and name what I\'m feeling precisely before I react. Specifically, I will...'
        )}
      `
    },

    // ‚îÄ‚îÄ STEP 9: Complete ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'complete',
      render: () => B.complete(
        'What Emotions Actually Are',
        'emotional',
        'em-2',
        'üè∑',
        'Name It to Soften It',
        'Precise emotional labelling reduces intensity'
      )
    }

  ];

  document.addEventListener('DOMContentLoaded', () => {
    ModuleEngine.init('em-1', EM1_STEPS);
  });

  </script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch(() => {});
    }
  </script>
</body>
</html>
