<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0d0906">
  <title>InnerShadow ‚Äì The Stories We Tell Ourselves</title>
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="/css/main.css">
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    html, body {
      position: fixed;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-dark);
    }

    .shell {
      width: 100%;
      max-width: 28rem;
      height: 100vh;
      height: -webkit-fill-available;
      background: var(--bg-card);
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
      border-left: 1px solid var(--border-subtle);
      border-right: 1px solid var(--border-subtle);
    }

    .module-header {
      padding: max(1rem, env(safe-area-inset-top)) 1.25rem 0.875rem;
      background: rgba(10,15,30,0.95);
      border-bottom: 1px solid var(--border-subtle);
      flex-shrink: 0;
      z-index: 10;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .module-header__row {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }

    .header-back {
      width: 2.25rem;
      height: 2.25rem;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-card-light);
      border: 1px solid var(--border-soft);
      border-radius: 0.625rem;
      color: var(--text-primary);
      font-size: 1rem;
      cursor: pointer;
      transition: var(--transition-fast);
      flex-shrink: 0;
    }

    .header-back:active { transform: scale(0.92); }

    .header-title {
      flex: 1;
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.3;
      text-align: center;
    }

    .header-count {
      font-size: 0.8125rem;
      color: var(--text-muted);
      font-weight: 500;
      min-width: 2.25rem;
      text-align: right;
    }

    .progress-dots {
      display: flex;
      gap: 0.3rem;
    }

    .progress-dot {
      flex: 1;
      height: 3px;
      background: rgba(148,163,184,0.15);
      border-radius: 999px;
      transition: background 0.4s ease;
    }

    .progress-dot--active {
      background: var(--gradient-main);
    }

    .module-scroll {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }

    .module-scroll::-webkit-scrollbar { display: none; }

    .step-wrap {
      padding: 1.375rem 1.25rem 2rem;
    }

    .cta-area {
      padding: 1rem 1.25rem max(1rem, env(safe-area-inset-bottom));
      background: rgba(10,15,30,0.95);
      border-top: 1px solid var(--border-subtle);
      display: flex;
      gap: 0.75rem;
      align-items: center;
      flex-shrink: 0;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .back-btn-sm {
      width: 3rem;
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-card-light);
      border: 1px solid var(--border-soft);
      border-radius: 0.875rem;
      color: var(--text-secondary);
      font-size: 1.125rem;
      cursor: pointer;
      transition: var(--transition-fast);
      flex-shrink: 0;
    }

    .back-btn-sm:active { transform: scale(0.92); }
    .back-btn-sm:disabled { opacity: 0.3; cursor: default; }

    /* Story dissection cards */
    .story-card {
      background: var(--bg-card-light);
      border: 1px solid var(--border-soft);
      border-radius: 1.125rem;
      overflow: hidden;
      margin-bottom: 0.75rem;
    }

    .story-card__header {
      padding: 0.875rem 1rem 0.625rem;
      border-bottom: 1px solid var(--border-subtle);
    }

    .story-card__tag {
      font-size: 0.6875rem;
      font-weight: 700;
      letter-spacing: 0.07em;
      text-transform: uppercase;
      margin-bottom: 0.3rem;
    }

    .story-card__tag--event  { color: var(--text-muted); }
    .story-card__tag--story  { color: var(--text-red); }
    .story-card__tag--reframe { color: var(--text-ember); }

    .story-card__text {
      font-size: 0.9375rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .story-card__body {
      padding: 0.875rem 1rem;
    }

    /* Distortion chips */
    .distortion-grid {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .distortion-item {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.875rem 1rem;
      background: var(--bg-card-light);
      border: 1.5px solid var(--border-soft);
      border-radius: 0.875rem;
      cursor: pointer;
      transition: all 0.18s ease;
      font-family: var(--font-body);
      text-align: left;
      width: 100%;
    }

    .distortion-item:active { transform: scale(0.98); }

    .distortion-item--selected {
      border-color: var(--red-border-strong);
      background: var(--red-bg);
    }

    .distortion-item__name {
      font-size: 0.875rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 0.2rem;
    }

    .distortion-item--selected .distortion-item__name {
      color: var(--text-red);
    }

    .distortion-item__desc {
      font-size: 0.8125rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    @media (min-width: 640px) {
      .shell {
        height: 844px;
        max-height: 92vh;
        border-radius: 2.5rem;
        border: 1px solid var(--border-subtle);
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="bg-orb bg-orb--ember"></div>
    <div class="bg-orb bg-orb--amber"></div>

    <div class="module-header">
      <div class="module-header__row">
        <button class="header-back" onclick="ModuleEngine.goBackToPathway()">‚Üê</button>
        <p class="header-title" id="moduleTitle">The Stories We Tell Ourselves</p>
        <span class="header-count" id="stepCounter"></span>
      </div>
      <div class="progress-dots" id="progressDots"></div>
    </div>

    <div class="module-scroll" id="moduleScroll">
      <div class="step-wrap" id="stepContent"></div>
    </div>

    <div class="cta-area">
      <button class="back-btn-sm" id="backBtn" onclick="ModuleEngine.back()" disabled>‚Üê</button>
      <button class="btn btn--primary" id="nextBtn" onclick="ModuleEngine.next()">Continue</button>
    </div>
  </div>

  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <div class="loading-text" id="loadingText">Loading...</div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="/js/supabase-client.js"></script>
  <script src="/js/utils.js"></script>
  <script src="/js/module-engine.js"></script>
  <script>

  const B = ModuleEngine.Blocks;

  // ‚îÄ‚îÄ Distortion selector ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  function toggleDistortion(el) {
    el.classList.toggle('distortion-item--selected');
    const selected = Array.from(
      document.querySelectorAll('.distortion-item--selected')
    ).map(e => e.querySelector('.distortion-item__name').textContent);
    const hidden = document.getElementById('distortionsHidden');
    if (hidden) hidden.value = selected.join(', ');
  }

  // ================================================================
  // COGNITIVE DISTORTIONS DATA
  // ================================================================

  const DISTORTIONS = [
    {
      name: 'Mind reading',
      desc: 'Assuming you know what someone else is thinking ‚Äî usually negative ‚Äî without evidence'
    },
    {
      name: 'Catastrophising',
      desc: 'Jumping to the worst possible outcome. "This will ruin everything."'
    },
    {
      name: 'All-or-nothing thinking',
      desc: 'Seeing in extremes. No middle ground. Perfect or failure. Always or never.'
    },
    {
      name: 'Personalising',
      desc: 'Assuming you\'re responsible for things that had nothing to do with you'
    },
    {
      name: 'Emotional reasoning',
      desc: 'Treating feelings as facts. "I feel like a failure therefore I am one."'
    },
    {
      name: 'Should statements',
      desc: 'Rigid rules about how you or others must behave. Followed by guilt or resentment when violated.'
    },
    {
      name: 'Overgeneralising',
      desc: 'One bad event becomes a permanent pattern. "This always happens to me."'
    },
    {
      name: 'Filtering',
      desc: 'Focusing entirely on the negative while ignoring contradicting positives'
    }
  ];

  // ================================================================
  // MODULE STEPS
  // ================================================================

  const EM3_STEPS = [

    // ‚îÄ‚îÄ STEP 1: Intro ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'intro',
      render: () => `
        ${B.heading('You are not upset by what happens. You\'re upset by what you tell yourself it means.')}
        ${B.para('This is one of the most important and most misunderstood ideas in all of psychology. It doesn\'t mean your pain isn\'t real. It doesn\'t mean the event doesn\'t matter. It means there\'s a step between the event and your suffering that most people never examine.')}
        ${B.para('That step is the story.')}
        ${B.callout('The event is what happened. The story is what you decided it meant. Most of your suffering lives in the story ‚Äî not the event.')}
        ${B.para('This module teaches you to see the story for what it is: a hypothesis, not a fact. And hypotheses can be checked, revised, and sometimes discarded entirely.')}
      `
    },

    // ‚îÄ‚îÄ STEP 2: Concept ‚Äî Event vs story ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'concept',
      render: () => `
        ${B.heading('The gap between event and meaning.')}
        ${B.para('Here\'s how it actually works. Every experience passes through an invisible filter before you feel anything about it:')}

        <div style="
          display:flex;flex-direction:column;gap:0.375rem;
          margin-bottom:1.25rem;
          position:relative;
        ">
          ${[
            ['‚ö°','Event','Something happens in the world or in your mind'],
            ['üß†','Automatic thought','An instant, often unconscious interpretation fires'],
            ['üìñ','Story','You elaborate: add meaning, predict outcomes, assign blame'],
            ['üí•','Emotion','You feel something ‚Äî based on the story, not the event'],
            ['üé¨','Behaviour','You act ‚Äî based on the emotion, based on the story']
          ].map(([emoji, label, desc], i) => `
            <div style="
              display:flex;align-items:center;gap:0.875rem;
              padding:0.875rem 1rem;
              background:var(--bg-card-light);
              border:1px solid var(--border-soft);
              border-radius:0.875rem;
            ">
              <span style="font-size:1.25rem;flex-shrink:0">${emoji}</span>
              <div>
                <p style="font-size:0.8125rem;font-weight:700;color:var(--text-primary);margin-bottom:0.15rem">${label}</p>
                <p style="font-size:0.8125rem;color:var(--text-secondary);line-height:1.4">${desc}</p>
              </div>
            </div>
            ${i < 4 ? '<div style="text-align:center;color:var(--text-muted);font-size:0.875rem;line-height:1">‚Üì</div>' : ''}
          `).join('')}
        </div>

        ${B.insight('The intervention point', 'You can\'t always control the event. You have limited control over the automatic thought ‚Äî it fires before you\'re aware. But you have real influence over the story. That\'s where the work is.')}
      `
    },

    // ‚îÄ‚îÄ STEP 3: Concept ‚Äî Real example ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'concept',
      render: () => `
        ${B.heading('Same event. Completely different story. Completely different life.')}
        ${B.para('Look at this one event and how differently it can land:')}

        <div style="
          background:var(--bg-card-light);
          border:1px solid var(--border-soft);
          border-radius:1rem;
          padding:1rem 1.125rem;
          margin-bottom:1rem;
          text-align:center;
        ">
          <p style="font-size:0.75rem;font-weight:700;text-transform:uppercase;letter-spacing:0.06em;color:var(--text-muted);margin-bottom:0.5rem">The event</p>
          <p style="font-size:0.9375rem;font-weight:600;color:var(--text-primary)">
            A friend doesn't reply to your message for two days.
          </p>
        </div>

        <div style="display:flex;flex-direction:column;gap:0.625rem;margin-bottom:1.25rem">
          ${[
            ['üò∞', 'Story A', 'They\'re angry at me. I said something wrong. This friendship is ending.', 'Anxiety, dread, self-blame'],
            ['üòê', 'Story B', 'They\'re busy. They\'ll reply when they can. Nothing is wrong.', 'Mild curiosity, no distress'],
            ['üòû', 'Story C', 'They don\'t actually care about me. I\'m not a priority to anyone.', 'Sadness, loneliness, withdrawal'],
            ['üò†', 'Story D', 'That\'s so rude. Basic courtesy takes 30 seconds.', 'Irritation, distance, resentment']
          ].map(([emoji, label, story, result]) => `
            <div style="
              padding:0.875rem 1rem;
              background:var(--bg-card-light);
              border:1px solid var(--border-soft);
              border-radius:0.875rem;
            ">
              <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.375rem">
                <span style="font-size:1.125rem">${emoji}</span>
                <p style="font-size:0.8125rem;font-weight:700;color:var(--text-primary)">${label}</p>
              </div>
              <p style="font-size:0.875rem;color:var(--text-secondary);line-height:1.5;margin-bottom:0.375rem">"${story}"</p>
              <p style="font-size:0.75rem;color:var(--text-muted)">‚Üí Feels like: ${result}</p>
            </div>
          `).join('')}
        </div>

        ${B.para('One event. Four completely different emotional experiences. Four completely different behaviours that follow. <strong style="color:var(--text-primary)">The event didn\'t cause the feeling. The story did.</strong>')}
      `
    },

    // ‚îÄ‚îÄ STEP 4: Concept ‚Äî Cognitive distortions ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'concept',
      render: () => `
        ${B.heading('The patterns that make stories worse.')}
        ${B.para('Our stories don\'t go wrong randomly. They go wrong in predictable, identifiable ways ‚Äî called cognitive distortions. Aaron Beck identified these in the 1960s and they\'ve held up solidly since.')}
        ${B.para('Learning to recognise them doesn\'t make them disappear. But naming a distortion when you\'re inside it creates just enough distance to question the story.')}

        <div style="display:flex;flex-direction:column;gap:0.5rem;margin-bottom:1rem">
          ${DISTORTIONS.map(d => `
            <div style="
              padding:0.875rem 1rem;
              background:var(--bg-card-light);
              border:1px solid var(--border-soft);
              border-radius:0.875rem;
            ">
              <p style="font-size:0.875rem;font-weight:700;color:var(--text-primary);margin-bottom:0.25rem">${d.name}</p>
              <p style="font-size:0.8125rem;color:var(--text-secondary);line-height:1.5">${d.desc}</p>
            </div>
          `).join('')}
        </div>

        ${B.callout('You don\'t need to memorise all of these. You need to notice which ones you use most ‚Äî they\'ll show up in the worksheet next.')}
      `
    },

    // ‚îÄ‚îÄ STEP 5: Worksheet ‚Äî Dissect your own story ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'worksheet',
      render: () => `
        ${B.heading('Dissect a real story.')}
        ${B.para('Pick a situation from the last week or two where you felt something difficult ‚Äî frustration, hurt, anxiety, shame, anything. Now we\'re going to separate the event from the story.')}

        ${B.divider('The situation')}
        ${B.keyedTextarea('event', 'What actually happened?', 'Just the observable facts ‚Äî what a camera would have recorded. No interpretation yet.', '75px')}

        ${B.divider('The story')}
        ${B.keyedTextarea('story', 'What story did I tell myself about it?', 'The meaning you added. The assumptions. What it meant about them, about you, about the future.', '90px')}

        ${B.divider('The feeling')}
        ${B.keyedTextarea('feeling', 'What did I feel as a result?', 'Name it precisely ‚Äî use the vocabulary from module 1 if that helps.', '60px')}

        ${B.insight('The question to hold', 'Is the story definitely true? Not whether it feels true ‚Äî can you actually know it\'s true?')}
      `
    },

    // ‚îÄ‚îÄ STEP 6: Worksheet ‚Äî Spot the distortion ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'worksheet',
      render: () => `
        ${B.heading('Which patterns showed up?')}
        ${B.para('Look at the story you wrote. Which of these thinking patterns can you see in it? Select everything that applies ‚Äî most stories use more than one.')}

        <div class="distortion-grid">
          ${DISTORTIONS.map(d => `
            <button class="distortion-item" onclick="toggleDistortion(this)">
              <div style="flex:1">
                <p class="distortion-item__name">${d.name}</p>
                <p class="distortion-item__desc">${d.desc}</p>
              </div>
            </button>
          `).join('')}
        </div>
        <input type="hidden" id="distortionsHidden" data-key="distortions" value="">

        ${B.keyedTextarea('distortion-note', 'The main distortion in my story was...', 'How specifically did it show up in what you wrote?', '75px')}
      `,
      afterRender: () => {
        const nextBtn = document.getElementById('nextBtn');
        if (nextBtn) nextBtn.disabled = false;
      }
    },

    // ‚îÄ‚îÄ STEP 7: Worksheet ‚Äî Reframe ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'worksheet',
      render: () => `
        ${B.heading('Find a more accurate story.')}
        ${B.para('This is not positive thinking. It\'s not pretending the event was fine. It\'s asking: given the facts, what are the other possible interpretations?')}
        ${B.para('A better story doesn\'t have to feel better. It just has to be more honest about what you actually know versus what you assumed.')}

        ${B.divider('Reframe')}
        ${B.keyedTextarea('reframe', 'A more accurate story might be...', 'What\'s another interpretation of the same facts? What would you say to a friend in this situation?', '90px')}

        ${B.keyedTextarea('cant-know', 'What I actually cannot know for certain is...', 'The parts of the story that were assumptions, not facts', '70px')}

        ${B.keyedTextarea('feels-different', 'With the more accurate story, I feel...', 'Does it shift anything? Even slightly?', '60px')}

        ${B.callout('Reframing rarely makes everything okay. What it does is end the unnecessary suffering ‚Äî the part added by the story, not the event itself.')}
      `
    },

    // ‚îÄ‚îÄ STEP 8: Skill ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'skill',
      render: () => `
        ${B.heading('Your third tool.')}
        ${B.para('This one is the backbone of cognitive therapy ‚Äî simplified into something you can actually use in the moment, not just in reflection.')}
        ${B.skill(
          'Event vs Story',
          'Separate what happened from what you made it mean.',
          [
            '<strong>Write or say: "The event was..."</strong> Only what actually happened. No interpretation. Just observable facts ‚Äî what a camera would capture.',
            '<strong>Write or say: "The story I\'m telling is..."</strong> The meaning you added. The assumptions. The conclusions. The predictions.',
            '<strong>Ask: is the story definitely true?</strong> Not whether it feels true. Whether you can actually know it\'s true.',
            '<strong>Ask: what\'s another possible story?</strong> Not a positive spin ‚Äî just another interpretation of the same facts that you can\'t definitively rule out.',
            '<strong>Notice what shifts.</strong> Even 5% less certainty about the story creates space.'
          ]
        )}
        ${B.compare(
          'Before: Event ‚Üí story felt like fact ‚Üí full emotional impact of the story ‚Üí reaction based on story.',
          'After: Event ‚Üí story noticed as story ‚Üí story examined ‚Üí only the unavoidable part remains.'
        )}
      `
    },

    // ‚îÄ‚îÄ STEP 9: Commitment ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'commitment',
      render: () => `
        ${B.heading('Your commitment.')}
        ${B.para('Catching stories in real time ‚Äî while you\'re inside them ‚Äî is hard. It gets easier when you\'ve practised it in slower moments first.')}
        ${B.para('This week, when you notice a difficult feeling, do one event vs story exercise before you act on what you\'re feeling. Just one. Write it out, even briefly.')}
        ${B.commitment(
          'Think of a recurring situation where you often tell yourself a painful story. Commit to using Event vs Story there this week.',
          'This week when [situation] and I notice [feeling], I will stop and ask: what\'s the event, and what\'s the story I\'m adding? The story I usually default to is... and a more accurate one might be...'
        )}
      `
    },

    // ‚îÄ‚îÄ STEP 10: Complete ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    {
      type: 'complete',
      render: () => B.complete(
        'The Stories We Tell Ourselves',
        'emotional',
        'em-4',
        'üìñ',
        'Event vs Story',
        'Separate what happened from what you made it mean'
      )
    }

  ];

  document.addEventListener('DOMContentLoaded', () => {
    ModuleEngine.init('em-3', EM3_STEPS);
  });

  </script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch(() => {});
    }
  </script>
</body>
</html>
